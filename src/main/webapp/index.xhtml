<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:comp="http://xmlns.jcp.org/jsf/composite/components">
<h:head>
    <title>Quản lý OpenTalk</title>
</h:head>
<h:body>
    <h1>Danh sách OpenTalk</h1>
    <h:form id="mainForm">
        <h:dataTable value="#{opentalkBean.all}" var="opentalk" border="1">
            <h:column>
                <f:facet name="header">ID</f:facet>
                #{opentalk.id}
            </h:column>
            <h:column>
                <f:facet name="header">Tiêu đề</f:facet>
                #{opentalk.title}
            </h:column>
            <h:column>
                <f:facet name="header">Bắt đầu</f:facet>
                #{opentalk.startTime}
            </h:column>
            <h:column>
                <f:facet name="header">Kết thúc</f:facet>
                #{opentalk.endTime}
            </h:column>
            <h:column>
                <f:facet name="header">Hành động</f:facet>
                <h:commandButton action="#{opentalkBean.selectForUpdate(opentalk)}" value="Sửa">
                    <f:ajax execute="@form" render="updatePanel" />
                </h:commandButton>
                <h:commandButton action="#{opentalkBean.delete(opentalk)}" value="Xóa">
                	<f:ajax execute="@form" render="mainForm updatePanel" />
                </h:commandButton>
            </h:column>
        </h:dataTable>
    </h:form>
    
	<h:commandButton value="Thêm OpenTalk" action="#{opentalkBean.updateShowAddForm}" style="margin-top: 10px;">
	    <f:ajax execute="@this" render="addPanel" />
	</h:commandButton>
	
	<h:panelGroup id="addPanel">
	    <h:panelGroup rendered="#{opentalkBean.showAddForm}">
	        <comp:addOpentalk newOpentalk="#{opentalkBean.newOpentalk}" 
	                          addAction="#{opentalkBean.add}" />
	    </h:panelGroup>
	</h:panelGroup>
    
    <h:panelGroup id="updatePanel">
        <h:panelGroup rendered="#{not empty opentalkBean.selectedOpentalk}">
            <comp:updateOpentalk selectedOpentalk="#{opentalkBean.selectedOpentalk}" 
                                 updateAction="#{opentalkBean.update}" />
        </h:panelGroup>
    </h:panelGroup>
</h:body>
</html>
